<!doctype html><html itemscope itemtype=http://schema.org/WebPage lang=zh-cn><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=2"><meta name=robots content="noodp"><title>Hexo 部署到搬瓦工 VPS - 晴空小筑</title><meta name=author content="u0defined"><meta name=author-link content="http://clearsky.me/"><meta name=description content="Hexo 部署到搬瓦工 VPS"><meta name=keywords content="VPS,Hexo"><meta itemprop=name content="Hexo 部署到搬瓦工 VPS"><meta itemprop=description content="Hexo 部署到搬瓦工 VPS"><meta itemprop=datePublished content="2017-06-18T12:36:04+00:00"><meta itemprop=dateModified content="2023-05-02T19:18:14+08:00"><meta itemprop=wordCount content="1081"><meta itemprop=image content="https://clearsky.me/logo.png"><meta itemprop=keywords content="VPS,Hexo,"><meta property="og:title" content="Hexo 部署到搬瓦工 VPS"><meta property="og:description" content="Hexo 部署到搬瓦工 VPS"><meta property="og:type" content="article"><meta property="og:url" content="https://clearsky.me/hexo-deploy-to-vps/"><meta property="og:image" content="https://clearsky.me/logo.png"><meta property="article:section" content="posts"><meta property="article:published_time" content="2017-06-18T12:36:04+00:00"><meta property="article:modified_time" content="2023-05-02T19:18:14+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://clearsky.me/logo.png"><meta name=twitter:title content="Hexo 部署到搬瓦工 VPS"><meta name=twitter:description content="Hexo 部署到搬瓦工 VPS"><meta name=application-name content="晴空小筑"><meta name=apple-mobile-web-app-title content="晴空小筑"><meta name=theme-color data-light=#f8f8f8 data-dark=#252627 content="#f8f8f8"><meta name=msapplication-TileColor content="#da532c"><link rel="shortcut icon" type=image/x-icon href=/favicon.ico><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><link rel=manifest href=/site.webmanifest><link rel=canonical href=https://clearsky.me/hexo-deploy-to-vps/><link rel=prev href=https://clearsky.me/ubuntu-bbr/><link rel=next href=https://clearsky.me/lets-encrypt/><link rel=stylesheet href=/css/style.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.2.0/css/all.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","headline":"Hexo 部署到搬瓦工 VPS","inLanguage":"zh-CN","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/clearsky.me\/hexo-deploy-to-vps\/"},"genre":"posts","keywords":"VPS, Hexo","wordcount":1081,"url":"https:\/\/clearsky.me\/hexo-deploy-to-vps\/","datePublished":"2017-06-18T12:36:04+00:00","dateModified":"2023-05-02T19:18:14+08:00","publisher":{"@type":"Organization","name":""},"author":{"@type":"Person","name":"u0defined"},"description":"Hexo 部署到搬瓦工 VPS"}</script></head><body data-header-desktop=sticky data-header-mobile=auto><script>(window.localStorage?.getItem("theme")?localStorage.getItem("theme")==="dark":"auto"==="auto"?window.matchMedia("(prefers-color-scheme: dark)").matches:"auto"==="dark")&&document.body.setAttribute("data-theme","dark")</script><div class=wrapper data-page-style=normal><script>function randomPost(){fetch("/sitemap.xml").then(e=>e.text()).then(e=>(new window.DOMParser).parseFromString(e,"text/xml")).then(e=>{let s=e.querySelectorAll("url loc"),n,t;do n=s[Math.floor(Math.random()*s.length)].innerHTML,t=n.split("/")[3]||"";while(t==""||t=="tags"||t=="posts"||t=="categories")location.href=n})}function tofullScreen(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.msRequestFullscreen?e.msRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullscreen&&e.webkitRequestFullscreen()}</script><header class="desktop animate__faster" id=header-desktop><div class=header-wrapper data-github-corner=left><div class=header-title><a href=/ title=晴空小筑><span class=header-title-pre><i class='fas fa-code'></i> </span><span id=typeit-header-desktop class=typeit></span></a><span class=header-subtitle></span></div><nav><ul class=menu><li class=menu-item><a class=menu-link href=/><i class='fas fa-home'></i> 首页</a></li><li class=menu-item><a class=menu-link href=/posts><i class='fas fa-clock'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/tags><i class='fas fa-tags'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fas fa-book'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user-tie'></i> 关于</a></li><li class="menu-item delimiter"></li><li class="menu-item search" id=search-desktop><input type=text placeholder=在这里搜索一下... id=search-input-desktop>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-desktop title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-desktop title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-desktop><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></li><li class="menu-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></li><li class=menu-item><a class='fa-solid fa-expand' href=javascript:; onclick=tofullScreen() title=全屏阅读></a></li><li class=menu-item><a class='fa-regular fa-thumbs-up fa-bounce' href=javascript:; onclick=randomPost() title=随机访问一篇文章></a></li></ul></nav></div></header><header class="mobile animate__faster" id=header-mobile><div class=header-container><div class=header-wrapper><div class=header-title><a href=/ title=晴空小筑><span class=header-title-pre><i class='fas fa-code'></i> </span><span id=typeit-header-title-mobile class=typeit></span></a><span class=header-subtitle></span></div><div class=menu-toggle id=menu-toggle-mobile><span></span><span></span><span></span></div></div><nav><ul class=menu id=menu-mobile><li class=search-wrapper><div class="search mobile" id=search-mobile><input type=text placeholder=在这里搜索一下... id=search-input-mobile>
<a href=javascript:void(0); class="search-button search-toggle" id=search-toggle-mobile title=搜索><i class="fa-solid fa-search fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); class="search-button search-clear" id=search-clear-mobile title=清空><i class="fa-solid fa-times-circle fa-fw" aria-hidden=true></i></a>
<span class="search-button search-loading" id=search-loading-mobile><i class="fa-solid fa-spinner fa-fw fa-spin" aria-hidden=true></i></span></div><a href=javascript:void(0); class=search-cancel id=search-cancel-mobile>取消</a></li><li class=menu-item><a class=menu-link href=/><i class='fas fa-home'></i> 首页</a></li><li class=menu-item><a class=menu-link href=/posts><i class='fas fa-clock'></i> 文章</a></li><li class=menu-item><a class=menu-link href=/tags><i class='fas fa-tags'></i> 标签</a></li><li class=menu-item><a class=menu-link href=/categories/><i class='fas fa-book'></i> 分类</a></li><li class=menu-item><a class=menu-link href=/about><i class='fas fa-user-tie'></i> 关于</a></li><li class="menu-item menu-system"><span class="menu-system-item theme-switch" title=切换主题><i class="fa-solid fa-adjust fa-fw" aria-hidden=true></i></span></li></ul></nav></div></header><div class="search-dropdown desktop"><div id=search-dropdown-desktop></div></div><div class="search-dropdown mobile"><div id=search-dropdown-mobile></div></div><nav aria-label=breadcrumb class="breadcrumb-container sticky"><ol class=breadcrumb><li class=breadcrumb-item><a href=/ title=晴空小筑>主页</a></li><li class=breadcrumb-item><a href=/posts/ title=文章>文章</a></li><li class="breadcrumb-item active" aria-current=page>Hexo 部署到搬瓦工 VPS</li></ol></nav><main class=container><aside class=toc id=toc-auto><h2 class=toc-title>目录&nbsp;<i class="toc-icon fa-solid fa-angle-down fa-fw" aria-hidden=true></i></h2><div class=toc-content id=toc-content-auto></div></aside><aside class=aside-custom></aside><article class="page single"><div class=header><h1 class="single-title animate__animated animate__flipInX"><span>Hexo 部署到搬瓦工 VPS</span></h1></div><div class=post-meta><div class=post-meta-line><span class=post-author><a href=http://clearsky.me/ title=作者 target=_blank rel="external nofollow noopener noreferrer author" class=author><img loading=lazy src="https://gravatar.loli.net/avatar/e99a2f3e251df360c9ec3b2e50648c15?s=32&amp;d=mp" srcset="https://gravatar.loli.net/avatar/e99a2f3e251df360c9ec3b2e50648c15?s=32&amp;d=mp, https://gravatar.loli.net/avatar/e99a2f3e251df360c9ec3b2e50648c15?s=32&amp;d=mp 1.5x, https://gravatar.loli.net/avatar/e99a2f3e251df360c9ec3b2e50648c15?s=32&amp;d=mp 2x" sizes=auto data-title=u0defined data-alt=u0defined class=avatar style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'>&nbsp;u0defined</a></span>
<span class=post-category>收录于 <a href=/categories/%E5%AD%A6%E4%B9%A0%E5%A4%87%E5%BF%98/><i class="fa-regular fa-folder fa-fw" aria-hidden=true></i> 学习备忘</a></span></div><div class=post-meta-line><span title="发布于 2017-06-18 12:36:04"><i class="fa-regular fa-calendar-alt fa-fw me-1" aria-hidden=true></i><time datetime=2017-06-18>2017-06-18</time></span>&nbsp;<span title="更新于 2023-05-02 19:18:14"><i class="fa-regular fa-edit fa-fw me-1" aria-hidden=true></i><time datetime=2023-05-02>2023-05-02</time></span>&nbsp;<span><i class="fa-solid fa-pencil-alt fa-fw me-1" aria-hidden=true></i>约 1081 字</span>&nbsp;<span><i class="fa-regular fa-clock fa-fw me-1" aria-hidden=true></i>预计阅读 3 分钟</span>&nbsp;<span id=/hexo-deploy-to-vps/ class=comment-visitors data-flag-title="Hexo 部署到搬瓦工 VPS">
<i class="fa-regular fa-eye fa-fw me-1" aria-hidden=true></i><span id=twikoo_visitors>-</span>&nbsp;次阅读
</span>&nbsp;<span id=/hexo-deploy-to-vps/ class=comment-count data-flag-title="Hexo 部署到搬瓦工 VPS">
<i class="fa-regular fa-comments fa-fw me-1" aria-hidden=true></i><span id=twikoo-comment-count>-</span>&nbsp;条评论
</span>&nbsp;</div></div><div class="details toc" id=toc-static data-kept=true><div class="details-summary toc-title"><span>目录</span>
<span><i class="details-icon fa-solid fa-angle-right" aria-hidden=true></i></span></div><div class="details-content toc-content" id=toc-content-static><nav id=TableOfContents><ul><li><a href=#环境设定>环境设定</a></li><li><a href=#方案选择>方案选择</a></li><li><a href=#安装-git-和-nginx>安装 Git 和 Nginx</a><ul><li><a href=#配置-git>配置 Git</a></li><li><a href=#上传本地-ssh-公钥>上传本地 ssh 公钥</a></li><li><a href=#部署-git-库>部署 Git 库</a></li><li><a href=#授权配置钩子>授权配置钩子</a></li><li><a href=#配置-nginx>配置 Nginx</a></li></ul></li><li><a href=#配置-hexo-部署>配置 Hexo 部署</a></li><li><a href=#完成测试>完成测试</a></li></ul></nav></div></div><div class=content id=content data-end-flag=" ------------- 文章结束，感谢您的阅读。 ------------- "><h2 id=环境设定>环境设定</h2><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>信息<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ul><li>搬瓦工年付最便宜 $19.99 10G VPS，KVM 架构。</li><li>VPS 操作系统 Ubuntu 16.04.2 LTS ，已开启 <a href=https://clearsky.me/ubuntu-bbr.html target=_blank rel="external nofollow noopener noreferrer">Gooole TCP BBR</a>。</li><li>本地系统 Windows_NT 10.0.15063 win32 x64，已安装 Hexo 3.3.7，<a href=https://nodejs.org/zh-cn/ target=_blank rel="external nofollow noopener noreferrer">Node.js</a> 版本 6.10.3。</li><li>SSH 连接管理软件 <a href=https://www.netsarang.com/products/xsh_overview.html target=_blank rel="external nofollow noopener noreferrer">Xshell 5</a>，本地终端 <a href=https://git-for-windows.github.io/index.html target=_blank rel="external nofollow noopener noreferrer">Git for Windows</a> 2.13。</li></ul></div></div></div><h2 id=方案选择>方案选择</h2><p>传说中有 2 种方案：</p><div class="details admonition info open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-info-circle fa-fw" aria-hidden=true></i>信息<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><ol><li>在 VPS 安装配置 Hexo，完成后 <code>hexo server</code> 让它本地运行，之后通过配置 Nginx 让域名指向 <code>http://localhost:4000</code> 。</li><li>本地安装配置 Hexo，生成静态文件，然后 <code>git hook</code> 或者 <code>rsync</code> 这类方式部署到 VPS，Nginx 作为 Web 服务器解析。</li></ol></div></div></div><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><strong>因为我以前一直是本地生成静态文件部署到 github 或者 coding 上的，显然第二种方案适合我，在这里使用的是<code>git hook</code> 方式部署，因为 Google 搜索出来大多是这种方式，文章多，容易解决问题。</strong></div></div></div><h2 id=安装-git-和-nginx>安装 Git 和 Nginx</h2><p><code>root</code> 登录 VPS，安装 Git 和 Nginx。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>apt-get update
</span></span><span class=line><span class=cl>apt-get install git-core 
</span></span><span class=line><span class=cl>apt-get install nginx
</span></span></code></pre></td></tr></table></div></div><h3 id=配置-git>配置 Git</h3><p>新增一个用户 <code>git</code> ，并赋予操作权限。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>adduser git
</span></span></code></pre></td></tr></table></div></div><p>提示输入密码，并且填写一些身份信息。完成后赋予权限：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>740</span> /etc/sudoers
</span></span></code></pre></td></tr></table></div></div><p>编辑 <code>/etc/sudoers</code>，我用的 <code>nano</code> ，不会 <code>vi</code> 。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano /etc/sudoers
</span></span></code></pre></td></tr></table></div></div><p>在如下图位置添加 <code>git ALL=(ALL:ALL) ALL</code>：</p><p><figure><a class=lightgallery href=/hexo-deploy-to-vps/etc_sudoers.jpg data-thumbnail=/hexo-deploy-to-vps/etc_sudoers.jpg data-sub-html="<h2>etc_sudoers</h2><p>etc_sudoers</p>"><img loading=lazy src=etc_sudoers.jpg srcset="/hexo-deploy-to-vps/etc_sudoers.jpg, etc_sudoers.jpg 1.5x, /hexo-deploy-to-vps/etc_sudoers.jpg 2x" sizes=auto data-title=etc_sudoers data-alt=etc_sudoers width=830 height=544 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>etc_sudoers</figcaption></figure></p><p>之后保存，记得把权限改回来</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod <span class=m>440</span> /etc/sudoers
</span></span></code></pre></td></tr></table></div></div><div class="details admonition note open"><div class="details-summary admonition-title"><i class="icon fa-solid fa-pencil-alt fa-fw" aria-hidden=true></i>注意<i class="details-icon fa-solid fa-angle-right fa-fw" aria-hidden=true></i></div><div class=details-content><div class=admonition-content><strong>输入密码不可见，也无星号提示，输入一次，回车，再输一次再回车就好了。身份信息直接一路回车默认就好了。觉得 vi 操作麻烦可以用 nano 来编辑，注意添加位置。</strong></div></div></div><h3 id=上传本地-ssh-公钥>上传本地 ssh 公钥</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>su git		<span class=c1># 切换至 git 用户</span>
</span></span><span class=line><span class=cl><span class=nb>cd</span> ~
</span></span><span class=line><span class=cl>mkdir .ssh <span class=o>&amp;&amp;</span> <span class=nb>cd</span> .ssh
</span></span><span class=line><span class=cl>touch authorized_keys
</span></span><span class=line><span class=cl>nano authorized_keys 
</span></span></code></pre></td></tr></table></div></div><p>出现编辑框，这里需要把<code>本地</code> 公钥里面内容复制进，本地公钥在 <code>~/.ssh/id_rsa.pub</code> ，我是直接用编辑器打开复制进去的。复制完成保存。</p><p>然后测试一下连接，<strong>本地终端</strong>运行：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>ssh git@VPS IP 地址
</span></span></code></pre></td></tr></table></div></div><p>这里出错了，连不上，原因是搬瓦工默认连接端口不是 <code>22</code>，那么本地 <code>~/.ssh/</code> 目录下新建 <code>config</code> 文件 ( 注意没有后缀 )，内容如下：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>Host <span class=c1># VPS IP地址</span>
</span></span><span class=line><span class=cl>HostName <span class=c1># VPS IP地址</span>
</span></span><span class=line><span class=cl>User git
</span></span><span class=line><span class=cl>Port <span class=c1># SSH 端口</span>
</span></span><span class=line><span class=cl>IdentityFile ~/.ssh/id_rsa
</span></span></code></pre></td></tr></table></div></div><p>完成后再试一下，没问题了。</p><h3 id=部署-git-库>部署 Git 库</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~
</span></span><span class=line><span class=cl>mkdir hexo.git <span class=o>&amp;&amp;</span> <span class=nb>cd</span> hexo.git
</span></span><span class=line><span class=cl>git init --bare
</span></span></code></pre></td></tr></table></div></div><h3 id=授权配置钩子>授权配置钩子</h3><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> /var/www
</span></span><span class=line><span class=cl>sudo mkdir hexo		<span class=c1>#需要输入 git 用户密码</span>
</span></span><span class=line><span class=cl>sudo chown git:git -R /var/www/hexo
</span></span></code></pre></td></tr></table></div></div><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=nb>cd</span> ~/hexo.git/hooks
</span></span><span class=line><span class=cl>nano post-receive
</span></span></code></pre></td></tr></table></div></div><p>编辑框输入以下内容：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span><span class=lnt>4
</span><span class=lnt>5
</span><span class=lnt>6
</span><span class=lnt>7
</span><span class=lnt>8
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl><span class=cp>#!/bin/bash
</span></span></span><span class=line><span class=cl><span class=cp></span><span class=nv>GIT_REPO</span><span class=o>=</span>/home/git/hexo.git
</span></span><span class=line><span class=cl><span class=nv>TMP_GIT_CLONE</span><span class=o>=</span>/tmp/hexo
</span></span><span class=line><span class=cl><span class=nv>PUBLIC_WWW</span><span class=o>=</span>/var/www/hexo
</span></span><span class=line><span class=cl>rm -rf <span class=si>${</span><span class=nv>TMP_GIT_CLONE</span><span class=si>}</span>
</span></span><span class=line><span class=cl>git clone <span class=nv>$GIT_REPO</span> <span class=nv>$TMP_GIT_CLONE</span>
</span></span><span class=line><span class=cl>rm -rf <span class=si>${</span><span class=nv>PUBLIC_WWW</span><span class=si>}</span>/*
</span></span><span class=line><span class=cl>cp -rf <span class=si>${</span><span class=nv>TMP_GIT_CLONE</span><span class=si>}</span>/* <span class=si>${</span><span class=nv>PUBLIC_WWW</span><span class=si>}</span>
</span></span></code></pre></td></tr></table></div></div><p>并赋予权限</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>chmod +x post-receive
</span></span></code></pre></td></tr></table></div></div><p>至此，VPS Git 配置完成。记下来是 Nginx。</p><h3 id=配置-nginx>配置 Nginx</h3><p>为了方面先可以切换到 <code>root</code> 用户，首先配置 Nginx 站点文件：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>nano /etc/nginx/conf.d/hexo.conf
</span></span></code></pre></td></tr></table></div></div><p>输入以下内容并保存，酌情修改：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>server {
</span></span><span class=line><span class=cl>  listen  80 ;
</span></span><span class=line><span class=cl>  listen [::]:80;
</span></span><span class=line><span class=cl>  root /var/www/hexo;
</span></span><span class=line><span class=cl>  server_name clearsky.me www.clearsky.me;
</span></span><span class=line><span class=cl>  access_log  /var/log/nginx/hexo_access.log;
</span></span><span class=line><span class=cl>  error_log   /var/log/nginx/hexo_error.log;
</span></span><span class=line><span class=cl>  error_page 404 =  /404.html;
</span></span><span class=line><span class=cl>  location ~* ^.+\.(ico|gif|jpg|jpeg|png)$ {
</span></span><span class=line><span class=cl>    root /var/www/hexo;
</span></span><span class=line><span class=cl>    access_log   off;
</span></span><span class=line><span class=cl>    expires      1d;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  location ~* ^.+\.(css|js|txt|xml|swf|wav)$ {
</span></span><span class=line><span class=cl>    root /var/www/hexo;
</span></span><span class=line><span class=cl>    access_log   off;
</span></span><span class=line><span class=cl>    expires      10m;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  location / {
</span></span><span class=line><span class=cl>    root /var/www/hexo;
</span></span><span class=line><span class=cl>    if (-f $request_filename) {
</span></span><span class=line><span class=cl>    rewrite ^/(.*)$  /$1 break;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  location /nginx_status {
</span></span><span class=line><span class=cl>    stub_status on;
</span></span><span class=line><span class=cl>    access_log off;
</span></span><span class=line><span class=cl> }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></td></tr></table></div></div><p>完成后重启 Nginx。</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>/etc/init.d/nginx restart
</span></span></code></pre></td></tr></table></div></div><h2 id=配置-hexo-部署>配置 Hexo 部署</h2><p>和部署到 github 和 coding 一样，修改 Hexo 配置文件 <code>_config.yml</code> 的 <code>deploy</code> 部分：</p><div class=highlight><div class=chroma><table class=lntable><tr><td class=lntd><pre tabindex=0 class=chroma><code><span class=lnt>1
</span><span class=lnt>2
</span><span class=lnt>3
</span></code></pre></td><td class=lntd><pre tabindex=0 class=chroma><code class=language-yaml data-lang=yaml><span class=line><span class=cl><span class=nt>deploy</span><span class=p>:</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>type</span><span class=p>:</span><span class=w> </span><span class=l>git</span><span class=w>
</span></span></span><span class=line><span class=cl><span class=w>  </span><span class=nt>repo</span><span class=p>:</span><span class=w> </span><span class=l>git@VPS的IP:hexo.git,master</span><span class=w>
</span></span></span></code></pre></td></tr></table></div></div><h2 id=完成测试>完成测试</h2><p>和往常一样，<code>hexo g -d</code> ，看了一下没问题了。</p><p><figure><a class=lightgallery href=/hexo-deploy-to-vps/git-vps.jpg data-thumbnail=/hexo-deploy-to-vps/git-vps.jpg data-sub-html="<h2>git-vps</h2><p>git-vps</p>"><img loading=lazy src=git-vps.jpg srcset="/hexo-deploy-to-vps/git-vps.jpg, git-vps.jpg 1.5x, /hexo-deploy-to-vps/git-vps.jpg 2x" sizes=auto data-title=git-vps data-alt=git-vps width=742 height=406 style="background:url(/svg/loading.min.svg)no-repeat 50%" onload='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e);this.dataset.lazyloaded=""' onerror='this.title=this.dataset.title,this.alt=this.dataset.alt;for(const e of["style","data-title","data-alt","onerror","onload"])this.removeAttribute(e)'></a><figcaption class=image-caption>git-vps</figcaption></figure></p><p>先吃饭，回来再添加下 SSL 证书。</p></div><div class=post-footer id=post-footer><div class=post-info><div class=post-info-line><div class=post-info-mod><span title="更新于 2023-05-02 19:18:14">更新于 2023-05-02&nbsp;<a class=git-hash href=https://github.com/nyancccat/hugo-blog-source/commit/1cecf53f53bfac0297e7f4e94676cf414cfbe328 rel="external nofollow noopener noreferrer" target=_blank title="commit by nyancccat(theqee@gmail.com) 1cecf53f53bfac0297e7f4e94676cf414cfbe328: update"><i class="fa-solid fa-hashtag fa-fw" aria-hidden=true></i>1cecf53</a></span></div><div class=post-info-license><span><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a></span></div></div><div class=post-info-line><div class=post-info-md><span><a href=/hexo-deploy-to-vps/index.md title=阅读原始文档 class=link-to-markdown>阅读原始文档</a></span></div><div class=post-info-share><span><a href=javascript:void(0); title="分享到 Twitter" data-sharer=twitter data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS" data-hashtags=VPS,Hexo><i class="fa-brands fa-twitter fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Facebook" data-sharer=facebook data-url=https://clearsky.me/hexo-deploy-to-vps/ data-hashtag=VPS><i class="fa-brands fa-facebook-square fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 WhatsApp" data-sharer=whatsapp data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS" data-web><i class="fa-brands fa-whatsapp fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Line" data-sharer=line data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.12.0/icons/line.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 微博" data-sharer=weibo data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS"><i class="fa-brands fa-weibo fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Myspace" data-sharer=myspace data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS" data-description="Hexo 部署到搬瓦工 VPS"><i data-svg-src=https://cdn.jsdelivr.net/npm/simple-icons@7.12.0/icons/myspace.svg aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Blogger" data-sharer=blogger data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS" data-description="Hexo 部署到搬瓦工 VPS"><i class="fa-brands fa-blogger fa-fw" aria-hidden=true></i></a>
<a href=javascript:void(0); title="分享到 Evernote" data-sharer=evernote data-url=https://clearsky.me/hexo-deploy-to-vps/ data-title="Hexo 部署到搬瓦工 VPS"><i class="fa-brands fa-evernote fa-fw" aria-hidden=true></i></a></span></div></div></div><div class=post-info-more><section class=post-tags><i class="fa-solid fa-tags fa-fw me-1" aria-hidden=true></i><a href=/tags/vps/ class=post-tag>VPS</a><a href=/tags/hexo/ class=post-tag>Hexo</a></section><section><span><a href=javascript:void(0); onclick=window.history.back()>返回</a></span>&nbsp;|&nbsp;<span><a href=/>主页</a></span></section></div><div class=post-nav><a href=/ubuntu-bbr/ class=post-nav-item rel=prev title="Ubuntu 开启 BBR 拥塞控制算法加速 TCP"><i class="fa-solid fa-angle-left fa-fw" aria-hidden=true></i>Ubuntu 开启 BBR 拥塞控制算法加速 TCP</a>
<a href=/lets-encrypt/ class=post-nav-item rel=next title="申请 Let's Encrypt SSL 证书配置 Nginx 开启站点 HTTPS">申请 Let's Encrypt SSL 证书配置 Nginx 开启站点 HTTPS<i class="fa-solid fa-angle-right fa-fw" aria-hidden=true></i></a></div></div><div id=comments><div id=twikoo></div><noscript>Please enable JavaScript to view the comments powered by <a href=https://twikoo.js.org/ rel="external nofollow noopener noreferrer">Twikoo</a>.</noscript></div></article></main><footer class=footer><div class=footer-container><div class="footer-line custom"><span id=run-time></span></div><div class="footer-line powered order-1">由 <a href=https://gohugo.io/ target=_blank rel="external nofollow noopener noreferrer" title="Hugo 0.111.3">Hugo</a> 强力驱动 | 主题 - <a href=https://github.com/hugo-fixit/FixIt target=_blank rel=external title="FixIt v0.2.18"><img class=fixit-icon src=/fixit.min.svg alt="FixIt logo">&nbsp;FixIt</a>
| 托管于 <a title="Github Pages" href=https://docs.github.com/en/pages/ target=_blank rel="noopener noreffer">GitHub Pages</a></div><div class="footer-line copyright order-2" itemscope itemtype=http://schema.org/CreativeWork><a href="https://ipw.cn/ssl/?site=clearsky.me" title=本站支持SSL安全访问 target=_blank class=icon_ip rel="noopener noreferrer">SSL</a>
<i class="fa-regular fa-copyright fa-fw" aria-hidden=true></i>
<span itemprop=copyrightYear>2009 - 2023</span><span class=author itemprop=copyrightHolder>
<a href=http://clearsky.me/ target=_blank rel="external nofollow noopener noreferrer">u0defined</a></span><span class="license footer-divider"><a rel="license external nofollow noopener noreferrer" href=https://creativecommons.org/licenses/by-nc/4.0/ target=_blank>CC BY-NC 4.0</a> <a href="https://ipw.cn/ipv6webcheck/?site=clearsky.me" title=本站支持IPv6访问 target=_blank class=icon_ip>IPv6</a></span></div><div class="footer-line statistics order-3"></div></div></footer><script type=text/javascript src=https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.min.js></script>
<script type=text/javascript src=https://cdn.jsdelivr.net/npm/live2d-widget@3.1.4/lib/L2Dwidget.0.min.js></script>
<script type=text/javascript>L2Dwidget.init({model:{scale:1,hHeadPos:.5,vHeadPos:.618,jsonPath:"https://unpkg.com/live2d-widget-model-hijiki@1.0.5/assets/hijiki.model.json"},display:{superSample:1,width:180,height:390,position:"left",hOffset:100,vOffset:-60},mobile:{show:!1,scale:1,motion:!0},react:{opacityDefault:1,opacityOnHover:1}})</script></div><div class=widgets><div class="fixed-buttons animate__faster d-none"><div class="fixed-button back-to-top" role=button aria-label=回到顶部><i class="fa-solid fa-arrow-up fa-fw" aria-hidden=true></i><span class=variant-numeric>0%</span></div><div class="fixed-button view-comments d-none" role=button aria-label=查看评论><i class="fa-solid fa-comment fa-fw" aria-hidden=true></i></div></div><a href=https://github.com/nyancccat/ title="在 GitHub 上查看源代码" target=_blank rel="external nofollow" class="github-corner left d-none-mobile"><svg viewBox="0 0 250 250" aria-hidden="true"><path d="M0 0 115 115h15l12 27L250 250V0z"/><path d="M128.3 109C113.8 99.7 119 89.6 119 89.6 122 82.7 120.5 78.6 120.5 78.6 119.2 72 123.4 76.3 123.4 76.3 127.3 80.9 125.5 87.3 125.5 87.3 122.9 97.6 130.6 101.9 134.4 103.2" fill="currentcolor" style="transform-origin:130px 106px" class="octo-arm"/><path d="M115 115C114.9 115.1 118.7 116.5 119.8 115.4l13.9-13.8C136.9 99.2 139.9 98.4 142.2 98.6 133.8 88 127.5 74.4 143.8 58 148.5 53.4 154 51.2 159.7 51 160.3 49.4 163.2 43.6 171.4 40.1 171.4 40.1 176.1 42.5 178.8 56.2 183.1 58.6 187.2 61.8 190.9 65.4 194.5 69 197.7 73.2 200.1 77.6 213.8 80.2 216.3 84.9 216.3 84.9 212.7 93.1 206.9 96 205.4 96.6 205.1 102.4 203 107.8 198.3 112.5 181.9 128.9 168.3 122.5 157.7 114.1 157.9 116.9 156.7 120.9 152.7 124.9L141 136.5C139.8 137.7 141.6 141.9 141.8 141.8z" fill="currentcolor" class="octo-body"/></svg></a><div id=mask></div><div class=reading-progress-bar style=left:0;top:0></div><noscript><div class=noscript-warning>FixIt 主题在启用 JavaScript 的情况下效果最佳。</div></noscript></div><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/lightgallery@2.6.1/css/lightgallery-bundle.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.css><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.css><script src=https://cdn.jsdelivr.net/npm/twikoo@1.6.16/dist/twikoo.all.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/fuse.js@6.6.2/dist/fuse.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/twemoji@14.0.2/dist/twemoji.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.6.1/lightgallery.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.6.1/plugins/thumbnail/lg-thumbnail.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/lightgallery@2.6.1/plugins/zoom/lg-zoom.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/sharer.js@0.5.1/sharer.min.js async defer></script><script src=https://cdn.jsdelivr.net/npm/typeit@8.7.1/dist/index.umd.js defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/katex.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/auto-render.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/mhchem.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js defer></script><script src=https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js async defer></script><script>window.config={autoBookmark:!0,code:{copyTitle:"复制到剪贴板",editLockTitle:"锁定可编辑代码块",editUnLockTitle:"解锁可编辑代码块",editable:!0,maxShownLines:80},comment:{enable:!0,expired:!1,twikoo:{commentCount:!0,el:"#twikoo",envId:"https://blog-twikoo-three.vercel.app/",lang:"zh-cn"}},data:{"typeit-header-desktop":"晴空小筑","typeit-header-title-mobile":"晴空小筑"},enablePWA:!0,lightgallery:!0,math:{delimiters:[{display:!0,left:"$$",right:"$$"},{display:!0,left:"\\[",right:"\\]"},{display:!0,left:"\\begin{equation}",right:"\\end{equation}"},{display:!0,left:"\\begin{equation*}",right:"\\end{equation*}"},{display:!0,left:"\\begin{align}",right:"\\end{align}"},{display:!0,left:"\\begin{align*}",right:"\\end{align*}"},{display:!0,left:"\\begin{alignat}",right:"\\end{alignat}"},{display:!0,left:"\\begin{alignat*}",right:"\\end{alignat*}"},{display:!0,left:"\\begin{gather}",right:"\\end{gather}"},{display:!0,left:"\\begin{CD}",right:"\\end{CD}"},{display:!1,left:"$",right:"$"},{display:!1,left:"\\(",right:"\\)"}],strict:!1},pangu:{enable:!0,selector:"article"},search:{distance:100,findAllMatches:!1,fuseIndexURL:"/index.json",highlightTag:"em",ignoreFieldNorm:!1,ignoreLocation:!1,isCaseSensitive:!0,location:0,maxResultLength:10,minMatchCharLength:2,noResultsFound:"没有找到结果",snippetLength:50,threshold:.3,type:"fuse",useExtendedSearch:!1},twemoji:!0,typeit:{cursorChar:"|",cursorSpeed:1e3,data:{"typeit-header-desktop":["typeit-header-desktop"],"typeit-header-title-mobile":["typeit-header-title-mobile"]},duration:-1,loop:!1,speed:100}}</script><script src=/js/theme.min.js defer></script><script src=/js/custom.min.js defer></script></body></html>